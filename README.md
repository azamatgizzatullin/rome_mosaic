# Проект генерации мозаики

Этот проект предназначен для генерации мозаичных изображений из исходных фотографий. Он был доработан для удобного запуска с вашего компьютера.

## Структура проекта

```
mosaic_project/
├── main.py                   # Главный скрипт для запуска всего пайплайна
├── scripts/                  # Директория со вспомогательными скриптами обработки
│   ├── quantize_color_v3.py
│   ├── apply_good_contour_v4.py
│   ├── filter_thin_lines_v5.py
│   ├── lay_tesserae_contours_v6.py
│   └── fill_tesserae_areas_v7.py
├── input_image/              # Директория для ваших исходных изображений
│   └── appolo.jpg            # Пример исходного изображения
├── requirements.txt          # Файл с необходимыми Python-библиотеками
├── README.md                 # Этот файл с инструкциями
└── todo.md                   # Список выполненных доработок
```

## Подготовка к запуску

1.  **Распакуйте архив** с проектом в удобное для вас место на компьютере.
2.  **Установите Python 3.11** или новее, если он у вас не установлен.
3.  **Создайте виртуальное окружение** (рекомендуется) и активируйте его:
    ```bash
    python3 -m venv venv
    source venv/bin/activate  # для Linux/macOS
    # venv\Scripts\activate    # для Windows
    ```
4.  **Установите зависимости**, выполнив команду в терминале из корневой папки проекта (где находится `requirements.txt`):
    ```bash
    pip install -r requirements.txt
    ```

## Запуск пайплайна

Для запуска обработки изображения используйте скрипт `main.py`. Ему необходимо передать путь к исходному изображению и директорию для сохранения результатов.

**Пример команды для запуска:**

```bash
python main.py --input_image ./input_image/appolo.jpg --output_dir ./output_results
```

Эта команда:
*   Возьмет изображение `appolo.jpg` из папки `input_image`.
*   Создаст папку `output_results` (если она не существует) в корне проекта.
*   Внутри `output_results` создаст подпапку с уникальным именем (на основе имени файла и времени запуска), куда будут сохранены все промежуточные и финальные изображения, а также лог-файл `pipeline_log_YYYYMMDD_HHMMSS.log`.

### Параметры запуска (опционально)

Вы можете настроить некоторые параметры обработки, передав их при запуске `main.py`:

*   `--num_colors`: Количество цветов для квантования (по умолчанию: 16).
    *   Пример: `python main.py ... --num_colors 16`
*   `--min_thickness`: Минимальная толщина для фильтрации тонких линий в пикселях (по умолчанию: 3).
    *   Пример: `python main.py ... --min_thickness 5`
*   `--min_area_after_erosion`: Минимальная площадь после эрозии для фильтрации тонких линий (по умолчанию: 5).
    *   Пример: `python main.py ... --min_area_after_erosion 10`
*   `--tessera_width`: Приблизительная ширина тессеры в пикселях (по умолчанию: 10).
    *   Пример: `python main.py ... --tessera_width 8`
*   `--tessera_height`: Приблизительная высота тессеры в пикселях (по умолчанию: 15).
    *   Пример: `python main.py ... --tessera_height 12`

Полный пример с измененными параметрами:
```bash
python main.py --input_image ./input_image/appolo.jpg --output_dir ./output_results --num_colors 12 --min_thickness 4 --tessera_width 9
```

## Просмотр результатов

После успешного выполнения пайплайна все результаты будут находиться в указанной вами `--output_dir`, в подпапке с уникальным именем запуска. Вы найдете там:
*   Промежуточные изображения каждого этапа обработки.
*   Финальное изображение мозаики (например, `appolo_5_tess_filled.png`).
*   Лог-файл выполнения (`pipeline_log_....log`).

Если у вас возникнут вопросы, обращайтесь!
